<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.repository.EmpMapper">

	<select id="selectEmpList"
		parameterType="com.example.domain.EmpSearchVO"
		resultType="com.example.domain.EmpVO">

		SELECT
		e.EMP_NO 												AS empNo,
		e.EMP_NAME 										AS empName,
		e.EMP_PHONE 										AS empPhone,
		e.EMP_REGDATE 									AS empRegdate,

		d.DEPT_NAME AS deptName, -- DEPT 테이블 컬럼
		s.STATUS AS statusName -- EMP_STATUS.STATUS 컬럼

		FROM EMP e
					LEFT JOIN DEPT d 
			ON e.DEPT_NO = d.DEPT_NO
					LEFT JOIN EMP_STATUS s 
			ON e.STATUS_NO = s.STATUS_NO

		<where>
			<if test="keyword != null and keyword != ''">
				( e.EMP_NAME LIKE '%' || #{keyword} || '%'
				OR d.DEPT_NAME
				LIKE '%' || #{keyword} || '%'
				OR s.STATUS LIKE '%' || #{keyword} ||
				'%' )
			</if>
		</where>

		ORDER BY e.EMP_NO ASC
	</select>

	<!-- EmpMapper.xml -->
	<select id="getEmp" parameterType="String"
		resultType="com.example.domain.EmpVO">
		SELECT
		e.emp_no AS empNo,
		e.emp_name AS empName,
		e.emp_phone AS empPhone,
		e.emp_regdate AS empRegdate,
		e.base_sal AS baseSal, -- ★ 새로 추가한 기본급
		d.dept_name AS deptName,
		s.status AS statusName
		FROM EMP e
		LEFT JOIN DEPT d ON e.dept_no = d.dept_no
		LEFT JOIN EMP_STATUS s ON e.status_no = s.status_no
		WHERE e.emp_no = #{empNo}
	</select>

</mapper>